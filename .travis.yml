language: python
dist: bionic
services:
    - docker
python:
    - '3.6'
    - '3.7'
    - '3.8'
before_install:
  - docker pull wgxli/simplefhe-build
  - docker run -it -d --name build wgxli/simplefhe-build bash
  - docker exec -w /home build mkdir travis
  - docker exec -w /home/travis build mkdir build
  - docker exec -w /home/travis/build build mkdir wgxli
  - docker exec -w /home/travis/build/wgxli build git clone https://github.com/wgxli/simple-fhe.git
install:
  - pip install coveralls coverage
  - docker exec build pip3 install coverage
script:
  - docker exec -w /home/travis/build/wgxli/simple-fhe build coverage run --branch -m unittest discover tests
  - docker cp build:/home/travis/build/wgxli/simple-fhe/. .
  - ls -la
  - coverage report
after_success:
  - coveralls
